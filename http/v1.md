# HTTP REST API Specification v1

## Table of Contents

*   [General](#general)
    *   [Pagination](#pagination)
    *   [Network Id](#network-id)
    *   [Link Header](#link-header)
    *   [Rate Limits](#rate-limits)
    *   [Asset Data Encoding](#asset-data-encoding)
    *   [Errors](#errors)
    *   [Misc](#misc)
*   [REST API](#rest-api)
    *   [GET asset_pairs](#get-v1asset_pairs)
    *   [GET orders](#get-v1orders)
    *   [GET order](#get-v1orderorderhash)
    *   [GET orderbook](#get-v1orderbook)
    *   [POST order](#post-v1order)
    *   [POST order_config](#post-v1order_config)

## General

### Pagination

Requests that return multiple items should respond to the **?page** and **?per_page** parameters. For example:

```
curl https://api.example-relayer.com/v1/token_pairs?page=3&per_page=20
```

Page numbering should be 1-indexed, not 0-indexed. Maximum page size should be 100.

These requests include the `token_pairs`, `orders`, and `orderbook` endpoints.

### Network Id
All requests should be able to specify a **?networkId** query param for all supported networks. For example:
```
curl https://api.example-relayer.com/v1/token_pairs?networkId=1
```
If the query param is not provided, it should default to **1** (mainnet).

Networks and their Ids:

| Network Id| Network Name |
| ----------| ------------ |
| 1         | Mainnet      |
| 42        | Kovan        |
| 3         | Ropsten      |
| 4         | Rinkeby      |

 If a certain network is not supported, the response should **400**  as specified in the [error response](#error-response) section. For example:
 
```
{
    "code": 100,
    "reason": "Validation failed",
    "validationErrors": [
        {
            "field": "networkId",
            "code": 1006,
            "reason": "Network id 42 is not supported",
        }
    ]
}
```

### Link Header

A [Link Header](https://tools.ietf.org/html/rfc5988) can be included in a response to provide clients with more context about paging
For example:

```
Link: <https://api.example-relayer.com/v1/token_pairs?page=3&per_page=20>; rel="next",
<https://api.github.com/user/repos?page=10&per_page=20>; rel="last"
```

This `Link` response header contains one or more Hypermedia link relations.

The possible `rel` values are:

| Name  | Description                                                   |
| ----- | ------------------------------------------------------------- |
| next  | The link relation for the immediate next page of results.     |
| last  | The link relation for the last page of results.               |
| first | The link relation for the first page of results.              |
| prev  | The link relation for the immediate previous page of results. |

### Rate Limits

Rate limit guidance for clients can be optionally returned in the response headers:

| Header Name           | Description                                                                  |
| --------------------- | ---------------------------------------------------------------------------- |
| X-RateLimit-Limit     | The maximum number of requests you're permitted to make per hour.            |
| X-RateLimit-Remaining | The number of requests remaining in the current rate limit window.           |
| X-RateLimit-Reset     | The time at which the current rate limit window resets in UTC epoch seconds. |

For example:

```
curl -i https://api.example-relayer.com/v1/token_pairs
HTTP/1.1 200 OK
Date: Mon, 20 Oct 2017 12:30:06 GMT
Status: 200 OK
X-RateLimit-Limit: 60
X-RateLimit-Remaining: 56
X-RateLimit-Reset: 1372700873
```
When a rate limit is exceeded, a status of **429 Too Many Requests** should be returned.

### Asset Data Encoding

As we now support multiple proxies, the identifier of which proxy to use for the token transfer must be encoded, along with the token information. Each proxy in 0x v2 has a unique identifier. If you're using 0x.js there will be helper methods for this encoding and decoding. 

The identifier for the Proxy uses a similar scheme to ABI function selectors.
```
// ERC20 Proxy ID  0xf47261b0
bytes4(keccak256("ERC20Token(address)"))
// ERC721 Proxy ID 0x08e937fa
bytes4(keccak256("ERC721Token(address,uint256)"))
```

The encoding for asset data is [ABI encoding](https://solidity.readthedocs.io/en/develop/abi-spec.html). 

For example, encoding the ERC20 token contract (address:  0x1dc4c1cefef38a777b15aa20260a54e584b16c48) using the ERC20 Transfer Proxy (id: 0xf47261b0) would be:
```
0xf47261b00000000000000000000000001dc4c1cefef38a777b15aa20260a54e584b16c48
```

Encoding the ERC721 token contract (address: `0x371b13d97f4bf77d724e78c16b7dc74099f40e84`), token id (id: 99) and the ERC721 Transfer Proxy (id: 0x08e937fa) would be:
```
0x08e937fa000000000000000000000000371b13d97f4bf77d724e78c16b7dc74099f40e840000000000000000000000000000000000000000000000000000000000000063
```

For more information see [theAsset Proxy](https://github.com/0xProject/0x-protocol-specification/blob/master/v2/v2-specification.md#erc20proxy) section of the v2 spec and the [Ethereum ABI Spec](https://solidity.readthedocs.io/en/develop/abi-spec.html).


### Errors

Unless the spec defines otherwise, errors to bad requests should respond with HTTP 4xx or status codes.

#### Common error codes

| Code | Reason                                  |
| ---- | --------------------------------------- |
| 400  | Bad Request â€“ Invalid request format    |
| 404  | Not found                               |
| 429  | Too many requests - Rate limit exceeded |
| 500  | Internal Server Error                   |
| 501  | Not Implemented                         |

#### Error reporting format
For all **400** responses, see the [error response schema](https://github.com/0xProject/0x-monorepo/blob/development/packages/json-schemas/schemas/relayer_api_error_response_schema.ts#L1).

```
{
    "code": 101,
    "reason": "Validation failed",
    "validationErrors": [
        {
            "field": "maker",
            "code": 1002,
            "reason": "Invalid address"
        }
    ]
}
```

General error codes:

```
100 - Validation Failed
101 - Malformed JSON
102 - Order submission disabled
103 - Throttled
```

Validation error codes:

```
1000 - Required field
1001 - Incorrect format
1002 - Invalid address
1003 - Address not supported
1004 - Value out of range
1005 - Invalid signature or hash
1006 - Unsupported option
```


### Misc.

*   All requests and responses should be of **application/json** content type
*   All token amounts are sent in amounts of the smallest level of precision (base units). (e.g if a token has 18 decimal places, selling 1 token would show up as selling `'1000000000000000000'` units by this API).
*   All addresses are sent as lower-case (non-checksummed) Ethereum addresses with the `0x` prefix.

## REST API

### GET /v1/asset_pairs

Retrieves a list of available asset pairs and the information required to trade them. This endpoint should be paginated.

#### Parameters

*   assetDataA=&assetDataB [string]: these are assetData fields. Returns asset pairs that contain assetDataA and assetDataB (in any order). Setting only assetDataA or assetDataB returns pairs filtered by that asset only (optional)

#### Response

[See response schema](https://github.com/0xProject/0x-monorepo/blob/development/packages/json-schemas/schemas/relayer_api_token_pairs_response_schema.ts#L1)

```
[
    {
        "assetDataA": {
            "minAmount": "0",
            "maxAmount": "10000000000000000000",
            "precision": 5
        },
        "assetDataB": {
            "minAmount": "0",
            "maxAmount": "50000000000000000000",
            "precision": 5
        }
    },
    ...
]
```

*   `minAmount` - the minimum trade amount the relayer will accept
*   `maxAmount` - the maximum trade amount the relayer will accept
*   `precision` - the desired price precision a relayer would like to support within their orderbook

### GET /v1/orders

Retrieves a list of orders given query parameters. This endpoint should be paginated. For querying an entire orderbook snapshot, the [orderbook endpoint](#get-v1orderbook) is recommended.

#### Parameters

Filter parameters:
  *   makerAssetType [string]: returns orders where the maker asset is of certain asset type (example: `ERC20`, `ERC721`)
  *   takerAssetType [string]:  returns orders where the taker asset is of certain asset type (example: `ERC20`, `ERC721`)
  *   makerAssetAddress [string] returns orders where the contract address for the maker asset matches the value specified
  *   takerAssetAddress [string] returns orders where the contract address for the taker asset matches the value specified

Order specific parameters:
  *   exchangeAddress [string]: returns orders created for this exchange address
  *   senderAddress [string]: returns orders with the specified senderAddress
  *   makerAssetData [string]: returns orders with the specified makerAssetData
  *   takerAssetData [string]: returns orders with the specified takerAssetData
  *   traderAssetData [string]: returns orders where either makerAssetData or takerAssetData has the value specified
  *   makerAddress [string]: returns orders with the specified makerAddress
  *   takerAddress [string]: returns orders with the specified takerAddress
  *   traderAddress [string]: returns orders where either makerAddress or takerAddress has the value specified
  *   feeRecipientAddress [string]: returns orders where feeRecipientAddress is feeRecipient address

All parameters are optional.

If both makerAssetData and takerAssetData are specified, returned orders will be sorted by price determined by (takerTokenAmount/makerTokenAmount) in ascending order. By default, orders returned by this endpoint are unsorted.

#### Response

[See response schema](https://github.com/0xProject/0x-monorepo/blob/development/packages/json-schemas/schemas/signed_orders_schema.ts#L1)

```
[
    {
        "makerAddress": "0x9e56625509c2f60af937f23b7b532600390e8c8b",
        "takerAddress": "0xa2b31dacf30a9c50ca473337c01d8a201ae33e32",
        "feeRecipientAddress": "0xb046140686d052fff581f63f8136cce132e857da",
        "senderAddress": "0xa2b31dacf30a9c50ca473337c01d8a201ae33e32",
        "makerAssetAmount": "10000000000000000",
        "takerAssetAmount": "20000000000000000",
        "makerFee": "100000000000000",
        "takerFee": "200000000000000",
        "expirationTimeSeconds": "42",
        "salt": "67006738228878699843088602623665307406148487219438534730168799356281242528500",
        "makerAssetData": "0x01323b5d4c32345ced77393b3530b1eed0f346429d",
        "takerAssetData": "0x01ef7fff64389b814a946f3e92105513705ca6b990",
        "exchangeAddress": "0x12459c951127e0c374ff9105dda097662a027093",
        "signature": "0x012761a3ed31b43c8780e905a260a35faefcc527be7516aa11c0256729b5b351bc33"
    },
    ...
]
```

### GET /v1/order/[orderHash]

Retrieves a specific order by orderHash.

#### Response

[See response schema](https://github.com/0xProject/0x-monorepo/blob/development/packages/json-schemas/schemas/order_schemas.ts#L24)

```
{
            "makerAddress": "0x9e56625509c2f60af937f23b7b532600390e8c8b",
            "takerAddress": "0xa2b31dacf30a9c50ca473337c01d8a201ae33e32",
            "feeRecipientAddress": "0xb046140686d052fff581f63f8136cce132e857da",
            "senderAddress": "0xa2b31dacf30a9c50ca473337c01d8a201ae33e32",
            "makerAssetAmount": "10000000000000000",
            "takerAssetAmount": "20000000000000000",
            "makerFee": "100000000000000",
            "takerFee": "200000000000000",
            "expirationTimeSeconds": "42",
            "salt": "67006738228878699843088602623665307406148487219438534730168799356281242528500",
            "makerAssetData": "0x01323b5d4c32345ced77393b3530b1eed0f346429d",
            "takerAssetData": "0x01ef7fff64389b814a946f3e92105513705ca6b990",
            "exchangeAddress": "0x12459c951127e0c374ff9105dda097662a027093",
            "signature": "0x012761a3ed31b43c8780e905a260a35faefcc527be7516aa11c0256729b5b351bc33"
}
```

Returns HTTP 404 if no order with specified orderHash was found.

### GET /v1/orderbook

Retrieves the orderbook for a given asset pair.

#### Parameters

*   baseAssetData [string]: assetData (makerAssetData or takerAssetData) designated as the base currency in the [currency pair calculation](https://en.wikipedia.org/wiki/Currency_pair) of price (required)
*   quoteAssetData [string]: assetData (makerAssetData or takerAssetData) designated as the quote currency in the currency pair calculation of price (required)

#### Response

[See response schema](https://github.com/0xProject/0x-monorepo/blob/development/packages/json-schemas/schemas/relayer_api_orderbook_response_schema.ts#L1)

```
{
    "bids": [
        {
            "makerAddress": "0x9e56625509c2f60af937f23b7b532600390e8c8b",
            "takerAddress": "0xa2b31dacf30a9c50ca473337c01d8a201ae33e32",
            "feeRecipientAddress": "0xb046140686d052fff581f63f8136cce132e857da",
            "senderAddress": "0xa2b31dacf30a9c50ca473337c01d8a201ae33e32",
            "makerAssetAmount": "10000000000000000",
            "takerAssetAmount": "20000000000000000",
            "makerFee": "100000000000000",
            "takerFee": "200000000000000",
            "expirationTimeSeconds": "42",
            "salt": "67006738228878699843088602623665307406148487219438534730168799356281242528500",
            "makerAssetData": "0x01323b5d4c32345ced77393b3530b1eed0f346429d",
            "takerAssetData": "0x01ef7fff64389b814a946f3e92105513705ca6b990",
            "exchangeAddress": "0x12459c951127e0c374ff9105dda097662a027093",
            "signature": "0x012761a3ed31b43c8780e905a260a35faefcc527be7516aa11c0256729b5b351bc33"
        },
        ...
    ],
    "asks": [
        {
            "makerAddress": "0xa2b31dacf30a9c50ca473337c01d8a201ae33e32",
            "takerAddress": "0x9e56625509c2f60af937f23b7b532600390e8c8b",
            "feeRecipientAddress": "0xb046140686d052fff581f63f8136cce132e857da",
            "senderAddress": "0xa2b31dacf30a9c50ca473337c01d8a201ae33e32",
            "makerAssetAmount": "20000000000000000",
            "takerAssetAmount": "10000000000000000",
            "makerFee": "200000000000000",
            "takerFee": "100000000000000",
            "expirationTimeSeconds": "42",
            "salt": "67006738228878699843088602623665307406148487219438534730168799356281242528500",
            "makerAssetData": "0x01ef7fff64389b814a946f3e92105513705ca6b990",
            "takerAssetData": "0x01323b5d4c32345ced77393b3530b1eed0f346429d",
            "exchangeAddress": "0x12459c951127e0c374ff9105dda097662a027093",
            "signature": "0x013842a3ed31b43c8780e905a260a35faefcc527be7516aa11c0256729b5b3518891"
        },
        ...
    ]
}
```

*   `bids` - array of signed orders where `takerAssetData` is equal to `baseAssetData`
*   `asks` - array of signed orders where `makerAssetData` is equal to `baseAssetData`

Bids will be sorted in descending order by price, and asks will be sorted in ascending order by price. Within the price sorted orders, the orders are further sorted first by total fees, then by expiration in ascending order.

### POST /v1/order

Submit a signed order to the relayer.

#### Payload

[See payload schema](https://github.com/0xProject/0x-monorepo/blob/development/packages/json-schemas/schemas/order_schemas.ts#L24)

```
{
    "makerAddress": "0x9e56625509c2f60af937f23b7b532600390e8c8b",
    "takerAddress": "0xa2b31dacf30a9c50ca473337c01d8a201ae33e32",
    "feeRecipientAddress": "0xb046140686d052fff581f63f8136cce132e857da",
    "senderAddress": "0xa2b31dacf30a9c50ca473337c01d8a201ae33e32",
    "makerAssetAmount": "10000000000000000",
    "takerAssetAmount": "20000000000000000",
    "makerFee": "100000000000000",
    "takerFee": "200000000000000",
    "expirationTimeSeconds": "42",
    "salt": "67006738228878699843088602623665307406148487219438534730168799356281242528500",
    "makerAssetData": "0x01323b5d4c32345ced77393b3530b1eed0f346429d",
    "takerAssetData": "0x01ef7fff64389b814a946f3e92105513705ca6b990",
    "exchangeAddress": "0x12459c951127e0c374ff9105dda097662a027093",
    "signature": "0x012761a3ed31b43c8780e905a260a35faefcc527be7516aa11c0256729b5b351bc33"
}
```

#### Response

###### Success Response

Returns HTTP 201 upon success.

###### Error Response

Error response will be sent with a non-2xx HTTP status code. See the [Errors](#errors) section for more information.

### POST /v1/order_info

Submit a partial order and receive information required to complete the order: `senderAddress`, `feeRecipientAddress`, `makerFee`, `takerFee`. 

#### Payload

[See payload schema](https://github.com/0xProject/0x-monorepo/blob/development/packages/json-schemas/schemas/order_schemas.ts#L24)

```
{
    "makerAddress": "0x9e56625509c2f60af937f23b7b532600390e8c8b",
    "takerAddress": "0xa2b31dacf30a9c50ca473337c01d8a201ae33e32",
    "makerAssetAmount": "10000000000000000",
    "takerAssetAmount": "20000000000000000",
    "makerAssetData": "0x01323b5d4c32345ced77393b3530b1eed0f346429d",
    "takerAssetData": "0x01ef7fff64389b814a946f3e92105513705ca6b990",
    "exchangeAddress": "0x12459c951127e0c374ff9105dda097662a027093",
}
```

#### Response

###### Success Response

Returns a HTTP 201 response with the following payload:
```
{
    "senderAddress": "0xa2b31dacf30a9c50ca473337c01d8a201ae33e32",
    "feeRecipientAddress": "0xb046140686d052fff581f63f8136cce132e857da",
    "makerFee": "100000000000000",
    "takerFee": "200000000000000"
}
```

###### Error Response

Error response will be sent with a non-2xx HTTP status code. See the [Errors](#errors) section for more information.